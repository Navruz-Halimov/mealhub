<i18n>
{
  "en": {
    "title": "Directions",
    "chooseLocation": "My location",
    "chooseMapMarker": "Choose on the map",
    "chooseMapMarkerActive": "Choose on the map",
    "routeFromPlaceholder": "Enter a starting point",
    "routeToPlaceholder": "Enter a goal point",
    "time": "min",
    "btnFirstStep": "Get direction",
    "fieldError":"Check your fields",

    "bySteps": "Step by step",

    "shareToIphone":"iPhone 11",
    "shareCopy":"Copy link",

  "linkCopied": "Routing link copied",
  "linkCopiedError": "An error occurred while trying to share a way",

    "reviewLabel": "Reviews",
    "timeLabel": "Opened",
    "timeLabelClose": "Closed",
    "place": "availible",
    "noplace": "unavailible",

    "shareText":"Share",
    "sendText":"Send to phone",
    "sendTextFacebook":"Facebook",
    "sendTextTwitter":"Twitter",
    "sendTextInstagram":"Instagram",
    "sendTextTelegram":"Telegram",
    "sendTextWhatsapp":"WhatsApp",
    "sendTextViber":"Viber",
    "sendTextVK":"VK"
  },
  "ru": {
    "title": "Маршрут",
    "chooseLocation": "Мое местоположение",
    "chooseMapMarker": "Выбрать на карте",
    "chooseMapMarkerActive": "Выберите на карте",
    "routeFromPlaceholder": "Откуда",
    "routeToPlaceholder": "Куда",
    "time": "мин",
    "btnFirstStep": "Проложить маршрут",
    "fieldError":"Не введен адрес отправления или прибытия",

    "bySteps": "Маршрут по шагам",

    "shareToIphone":"iPhone 11",
    "shareCopy":"Скопировать ссылку",
  "linkCopied": "Ссылка на маршрут скопирована",
  "linkCopiedError": "Ошибка при попытке поделиться маршрутом",

    "reviewLabel": "Отзывы",
    "timeLabel": "Открыто",
    "timeLabelClose": "Закрыто",
    "place": "Доступны",
    "noplace": "нет",

    "shareText":"Поделиться",
    "sendText":"Отправить на телефон",
    "sendTextFacebook":"Facebook",
    "sendTextTwitter":"Twitter",
    "sendTextInstagram":"Instagram",
    "sendTextTelegram":"Telegram",
    "sendTextWhatsapp":"WhatsApp",
    "sendTextViber":"Viber",
    "sendTextVK":"VK"

  }
}
</i18n>

<template>
  <div class="route" :class="{ second: currentStep !== stepList.first }">
    <div class="route-back" :class="{ show: currentStep !== stepList.first }">
      <addition-back :stricted="true" @click-handler="goToBack" />
    </div>
    <h2
      v-if="currentStep === stepList.first && MAP_CHOISE_OPTION !== 'map'"
      class="route-title"
    >
      {{ $t('title') }}
    </h2>
    <h2 v-else-if="MAP_CHOISE_OPTION === 'map'" class="route-title mb-1">
      {{ $t('chooseMapMarkerActive') }}
    </h2>
    <div v-if="showRouteBody" ref="sharesendclick" class="route_body">
      <div
        v-if="
          currentStep !== stepList.first &&
            CURRENT_CATERING &&
            CURRENT_CATERING.name
        "
        ref="selectedCatteringFilter"
        class="top mt-2 ml-2 desktop"
        style="padding: 0"
      >
        <header class="top_header">
          <h2
            class="top_header-title"
            @click="
              $router.push(
                localePath({
                  path: `/catering/${CURRENT_CATERING.id}`
                })
              )
            "
          >
            {{ CURRENT_CATERING.name }}
          </h2>
        </header>
        <article class="top_article">
          <div
            class="top_article_rate"
            @click="
              $router.push(
                localePath({
                  path: `/catering/${CURRENT_CATERING.id}/reviews`
                })
              )
            "
          >
            <p class="top_article-count">
              {{ CURRENT_CATERING.rating }}
            </p>
            <addition-stars :rate="CURRENT_CATERING.rating" />
            <p class="top_article-review">
              {{ $t('reviewLabel') }}:
              <span>{{ CURRENT_CATERING.reviewsCount }}</span>
            </p>
          </div>
        </article>
        <footer class="top_footer">
          <p class="top_footer-time">
            <img
              class="top_footer-time-icon"
              :src="
                CURRENT_CATERING.opened
                  ? '/icons/catering/new/clock-green.svg'
                  : '/icons/catering/new/clock-grey.svg'
              "
              alt="t"
            >
            {{
              CURRENT_CATERING.opened ? $t('timeLabel') : $t('timeLabelClose')
            }}
          </p>
          <p
            class="top_footer-seats"
            :style="CURRENT_CATERING.free_tables > 0 ? '' : 'opacity:.4;'"
          >
            <img
              class="top_footer-seats-icon"
              src="/icons/catering/booking-table-black.svg"
              alt=""
            >
            {{ CURRENT_CATERING.free_tables > 0 ? $t('place') : $t('noplace') }}
          </p>
        </footer>
      </div>

      <div>
        <form class="route_form form" @submit.prevent>
          <div class="form_group">
            <div class="form-icon">
              <span class="form-icon-circle" />
              <span class="form-icon-dots" />
              <img src="/icons/map_green.svg" alt="">
            </div>

            <div
              class="form-address from"
              :class="{ error: $v.fromAddress.$error }"
            >
              <geo-place-autocomplete-field
                ref="locationFrom"
                v-model="fromAddress"
                :placeholder="$t('routeFromPlaceholder')"
              />
              <img
                class="form-address-clear"
                src="/icons/consumables/input-clear-icon.svg"
                alt=""
                @click.stop="clearFromAddress"
              >
            </div>
            <div
              class="form-address to"
              :class="{ error: $v.toAddress.$error }"
            >
              <geo-place-autocomplete-field
                ref="locationTo"
                v-model="toAddress"
                :disabled="isWay"
                :class="{ disabledAutocomplete: isWay }"
                :placeholder="$t('routeToPlaceholder')"
              />
              <img
                v-if="!isWay"
                class="form-address-clear"
                src="/icons/consumables/input-clear-icon.svg"
                alt=""
                @click.stop="clearToAddress"
              >
            </div>

            <div class="form_menu">
              <span class="form_menu-dots" @click.stop="toggleSettings">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  x="0"
                  y="0"
                  viewBox="0 0 54 55.24"
                  xml:space="preserve"
                >
                  <g transform="translate(238.5 565.629)">
                    <circle cx="-208.17" cy="-540.28" r="2.5" />
                    <circle cx="-208.17" cy="-533.28" r="2.5" />
                    <circle cx="-208.17" cy="-526.28" r="2.5" />
                  </g>
                </svg>
              </span>
              <ul class="form_menu_settings" :class="{ open: settingsIsOpen }">
                <li
                  class="form_menu-item"
                  @click="chooseLocationVariant('user')"
                >
                  {{ $t('chooseLocation') }}
                </li>
                <li
                  class="form_menu-item"
                  @click="chooseLocationVariant('map')"
                >
                  {{ $t('chooseMapMarker') }}
                </li>
              </ul>
            </div>
            <img
              v-if="isbuild !== true"
              class="form-change"
              src="/icons/consumables/refresh-arrows.svg"
              alt=""
              @click="changeLocations"
            >
          </div>
          <ul class="form_movements">
            <li
              class="form-movement"
              :class="{
                active:
                  GMAP_ROUTE.movementType === 'transit' &&
                  GMAP_ROUTE_DURATION.transit,
                disabled: !GMAP_ROUTE_DURATION.transit,
                error: $v.movementType.$error
              }"
              @click="
                GMAP_ROUTE_DURATION.transit && selectMovementType('transit')
              "
            >
              <span
                class="form-movement-icon"
              ><img
                src="~/assets/icons/bus.svg"
                alt=""
              ></span>

              <p v-if="GMAP_ROUTE_DURATION.transit" class="form-movement-txt">
                {{ GMAP_ROUTE_DURATION.transit }}
                {{ $t('time') }}.
              </p>
            </li>
            <li
              class="form-movement"
              :class="{
                active:
                  GMAP_ROUTE.movementType === 'driving' &&
                  GMAP_ROUTE_DURATION.driving,
                disabled: !GMAP_ROUTE_DURATION.driving,
                error: $v.movementType.$error
              }"
              @click="
                GMAP_ROUTE_DURATION.driving && selectMovementType('driving')
              "
            >
              <span
                class="form-movement-icon"
              ><img
                src="/icons/movement/car.svg"
                alt=""
              ></span>

              <p v-if="GMAP_ROUTE_DURATION.driving" class="form-movement-txt">
                {{ GMAP_ROUTE_DURATION.driving }}
                {{ $t('time') }}.
              </p>
            </li>
            <li
              class="form-movement"
              :class="{
                active:
                  GMAP_ROUTE.movementType === 'walking' &&
                  GMAP_ROUTE_DURATION.walking,
                disabled: !GMAP_ROUTE_DURATION.walking,
                error: $v.movementType.$error
              }"
              @click="
                GMAP_ROUTE_DURATION.walking && selectMovementType('walking')
              "
            >
              <span
                class="form-movement-icon"
              ><img
                src="/icons/movement/foot.svg"
                alt=""
              ></span>

              <p v-if="GMAP_ROUTE_DURATION.walking" class="form-movement-txt">
                {{ GMAP_ROUTE_DURATION.walking }}
                {{ $t('time') }}.
              </p>
            </li>
          </ul>
          <template v-if="!isWay">
            <button
              v-if="currentStep === stepList.first"
              :class="
                userCanAct &&
                  (GMAP_ROUTE_DURATION.transit ||
                    GMAP_ROUTE_DURATION.driving ||
                    GMAP_ROUTE_DURATION.walking)
                  ? 'form-btn mt-05 eatme-btn-red'
                  : 'form-btn mt-05 eatme-btn-disabled'
              "
              @click="nextStep"
            >
              <span class="desktop large_desktop">
                {{ $t('btnFirstStep') }}
              </span>
              <span class="desktop small_desktop text-center">
                <img height="18" src="/icons/_new/path-white.svg" alt="">
              </span>
              <span class="mobile">
                {{ $t('btnFirstStep') }}
              </span>
            </button>

            <span
              v-if="currentStep === stepList.first"
              class="desktop small_desktop text-lg text-center wide"
            >
              {{ $t('btnFirstStep') }}
            </span>
          </template>

          <span v-if="isFieldError" class="field-error">
            {{ $t('fieldError') }}
          </span>
        </form>
      </div>

      <ListTop
        v-if="
          isbuild !== true &&
            currentStep !== stepList.second &&
            currentStep !== stepList.third &&
            MAP_CHOISE_OPTION !== 'map'
        "
        toolbar="route"
        class="mt-1e"
      />

      <div v-if="currentStep !== stepList.first" class="route_share desktop">
        <div class="route_share-detail">
          <div class="send_container">
            <div class="abcblock" @click.stop="isSendActive = !isSendActive">
              <button
                class="desktop btn-send"
                :class="userCanAct ? 'eatme-btn-red' : 'eatme-btn-disabled'"
              >
                <span class="large_desktop text-lg">
                  {{ $t('sendText') }}
                </span>
                <span class="small_desktop text-center icon">
                  <img src="/icons/send-btn.svg" alt="">
                </span>
              </button>
              <span class="desktop small_desktop text-lg btn-send-text">
                {{ $t('sendText') }}
              </span>

              <button
                class="mobile btn-send"
                :class="userCanAct ? 'eatme-btn-orange' : 'eatme-btn-disabled'"
              >
                <span class="text-center icon">
                  <img src="/icons/send-btn.svg" alt="">
                </span>
              </button>
              <span class="mobile text-lg btn-send-text">
                {{ $t('sendText') }}
              </span>
            </div>

            <ul
              class="form_menu_settings share"
              :class="{ open: isSendActive }"
            >
              <li class="form_menu-item" @click.stop="copyRouteLink()">
                <svg
                  class="share_svg"
                  fill="none"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1144 7.93896H6.46484V14.4483H11.1144V7.93896Z"
                    stroke-linejoin="round"
                  />
                  <path d="M8.21582 6H13.9998" stroke-linecap="round" />
                  <path d="M14 6V13.7182" stroke-linecap="round" />
                  <path d="M14.0001 13.7183H12.7168" />
                  <circle cx="10" cy="10" r="9.5" />
                </svg>
                {{ $t('shareCopy') }}
              </li>
              <li class="form_menu-item" @click.stop="copyRouteLink()">
                <svg
                  class="shareMob_svg"
                  viewBox="0 0 20 20"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <circle cx="10" cy="10" r="9.5" />
                  <path
                    class="path"
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M13.143 13.0588H8.06443V14.1046C8.06443 14.4532 8.35151 14.7403 8.70011 14.7403H12.5074C12.856 14.7403 13.143 14.4532 13.143 14.1046V13.0588ZM10.1492 6.21668C10.0808 6.21668 10.0193 6.15516 10.0193 6.08681C10.0193 6.01846 10.074 5.95694 10.1492 5.95694H11.1335C11.2018 5.95694 11.2633 6.01162 11.2633 6.08681C11.2633 6.15516 11.2087 6.21668 11.1335 6.21668H10.1492ZM10.6413 13.3185C10.9557 13.3185 11.2087 13.5714 11.2087 13.8858C11.2087 14.0362 11.1471 14.1798 11.0446 14.2891C10.8259 14.5079 10.4636 14.5079 10.2449 14.2891C10.0261 14.0704 10.0261 13.7081 10.2449 13.4894C10.3474 13.38 10.4909 13.3185 10.6413 13.3185ZM10.8601 13.6671C10.9831 13.7902 10.9831 13.9815 10.8601 14.1046C10.737 14.2276 10.5456 14.2276 10.4226 14.1046C10.2996 13.9815 10.2996 13.7902 10.4226 13.6671C10.5456 13.5441 10.737 13.5441 10.8601 13.6671ZM8.06443 12.799H13.143V7.00957H8.06443V12.799ZM8.06443 6.74983H13.143V5.89542C13.143 5.54682 12.856 5.25974 12.5074 5.25974H8.70011C8.35151 5.25974 8.06443 5.54682 8.06443 5.89542V6.74983ZM8.70011 5H12.5074C12.9995 5 13.4028 5.40328 13.4028 5.89542V14.1046C13.4028 14.5967 12.9995 15 12.5074 15H8.70011C8.20797 15 7.80469 14.5967 7.80469 14.1046V5.89542C7.80469 5.40328 8.20797 5 8.70011 5Z"
                    stroke-width="0.2"
                  />
                  <path
                    d="M5 10L10.679 10.0527"
                    stroke-width="0.75"
                    stroke-linecap="round"
                  />
                  <path
                    d="M8.97266 11.0994L10.679 10.0527"
                    stroke-width="0.75"
                    stroke-linecap="round"
                  />
                  <path
                    d="M8.97266 9L10.679 10.053"
                    stroke-width="0.75"
                    stroke-linecap="round"
                  />
                </svg>

                {{ $t('sendText') }}
              </li>
            </ul>
          </div>

          <div class="share_container">
            <div class="abcblock" @click.stop="isShareActive = !isShareActive">
              <p class="route_share-text desktop">
                {{ $t('shareText') }}
              </p>
              <svg
                class="share__icon"
                style="margin-left: 5px; cursor: pointer"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M10.9275 7.60791L8.92801 9.01495C9.08967 9.316 9.17461 9.65225 9.17534 9.99396V10.0117C9.1763 10.1812 9.15488 10.35 9.11166 10.5138C9.07335 10.6657 9.01795 10.8128 8.94652 10.9522L10.9838 12.3238L11.0238 12.2823C11.3054 12.0011 11.6822 11.8357 12.0798 11.8186C12.4774 11.8015 12.8669 11.934 13.1716 12.1899C13.4764 12.4459 13.6742 12.8067 13.726 13.2013C13.7779 13.5958 13.68 13.9955 13.4517 14.3215C13.2234 14.6474 12.8813 14.8761 12.4927 14.9622C12.1042 15.0484 11.6975 14.9859 11.3528 14.787C11.0081 14.5881 10.7504 14.2673 10.6306 13.8879C10.5107 13.5084 10.5374 13.0978 10.7053 12.737L8.66807 11.3655C8.63474 11.404 8.59994 11.4395 8.56365 11.478C8.27168 11.77 7.8997 11.9688 7.49475 12.0493C7.0898 12.1298 6.67008 12.0884 6.28864 11.9304C5.9072 11.7724 5.58116 11.5048 5.35179 11.1615C5.12241 10.8182 5 10.4146 5 10.0018C5 9.58888 5.12241 9.18525 5.35179 8.84195C5.58116 8.49865 5.9072 8.2311 6.28864 8.07308C6.67008 7.91507 7.0898 7.87369 7.49475 7.95421C7.8997 8.03473 8.27168 8.23354 8.56365 8.52546C8.59031 8.55212 8.615 8.57952 8.63771 8.60766L10.6705 7.18208C10.5244 6.81581 10.5195 6.40836 10.6566 6.03862C10.7937 5.66889 11.0631 5.36318 11.4127 5.18071C11.7623 4.99824 12.1671 4.95199 12.5488 5.05092C12.9306 5.14985 13.262 5.38694 13.479 5.71624C13.6959 6.04553 13.783 6.4436 13.7232 6.83339C13.6635 7.22318 13.4612 7.57693 13.1556 7.82613C12.85 8.07534 12.4627 8.20229 12.0689 8.18235C11.6751 8.16242 11.3027 7.99703 11.0238 7.71824C10.9897 7.68418 10.9571 7.64864 10.926 7.61162L10.9275 7.60791ZM12.927 12.6326C12.7476 12.4534 12.5117 12.3419 12.2593 12.3172C12.007 12.2924 11.7539 12.3559 11.5431 12.4969C11.3323 12.6378 11.177 12.8475 11.1034 13.0901C11.0299 13.3328 11.0428 13.5934 11.1399 13.8276C11.237 14.0619 11.4123 14.2552 11.6359 14.3746C11.8595 14.4941 12.1177 14.5324 12.3663 14.4829C12.615 14.4334 12.8388 14.2992 12.9997 14.1032C13.1605 13.9072 13.2484 13.6615 13.2484 13.4079C13.2486 13.2639 13.2203 13.1212 13.1651 12.9881C13.11 12.855 13.029 12.7342 12.927 12.6326ZM12.927 5.81947C12.7484 5.64094 12.5134 5.52988 12.262 5.5052C12.0107 5.48052 11.7586 5.54373 11.5486 5.6841C11.3387 5.82447 11.1839 6.0333 11.1107 6.275C11.0374 6.51669 11.0503 6.77629 11.147 7.00958C11.2437 7.24287 11.4183 7.43542 11.6411 7.55439C11.8638 7.67337 12.121 7.71142 12.3687 7.66206C12.6163 7.6127 12.8392 7.47899 12.9994 7.28372C13.1595 7.08844 13.247 6.84369 13.2469 6.59114C13.2471 6.44779 13.2189 6.30581 13.164 6.17339C13.1091 6.04096 13.0285 5.92067 12.927 5.81947ZM8.42962 10.8552C8.49717 10.7456 8.55303 10.6292 8.59624 10.5079C8.65138 10.3442 8.67939 10.1726 8.67919 9.9999C8.67919 9.96583 8.67919 9.932 8.67919 9.89843C8.64758 9.61018 8.55029 9.33303 8.39481 9.08827C8.19937 8.80944 7.91948 8.60082 7.59643 8.49321C7.27338 8.3856 6.92428 8.3847 6.60068 8.49064C6.27707 8.59657 5.9961 8.80374 5.79922 9.08156C5.60234 9.35937 5.49997 9.6931 5.50725 10.0335C5.51453 10.374 5.63108 10.703 5.83965 10.9722C6.04823 11.2413 6.33779 11.4363 6.66563 11.5283C6.99347 11.6203 7.34221 11.6044 7.66036 11.4831C7.97852 11.3618 8.24924 11.1414 8.43258 10.8545L8.42962 10.8552Z"
                  fill="#A2A2A2"
                  stroke="#A2A2A2"
                  stroke-width="0.5"
                />

                <circle cx="10" cy="10" r="9.5" stroke="#A2A2A2" />
              </svg>
            </div>
            <ul
              class="form_menu_settings send"
              :class="{ open: isShareActive }"
            >
              <li class="form_menu-item" @click.stop="copyRouteLink()">
                <svg
                  class="send_svg"
                  fill="none"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1144 7.93896H6.46484V14.4483H11.1144V7.93896Z"
                    stroke-linejoin="round"
                  />
                  <path d="M8.21582 6H13.9998" stroke-linecap="round" />
                  <path d="M14 6V13.7182" stroke-linecap="round" />
                  <path d="M14.0001 13.7183H12.7168" />
                  <circle cx="10" cy="10" r="9.5" />
                </svg>

                {{ $t('shareCopy') }}
              </li>
              <li class="social__list">
                <div
                  class="social__item"
                  @click.stop="copyRouteLink('facebook')"
                >
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      class="path"
                      d="M12.2029 5.00365H10.9047C10.5795 4.98522 10.2542 5.03679 9.95061 5.15488C9.64707 5.27296 9.3724 5.45481 9.14515 5.68814C8.91791 5.92147 8.74338 6.20085 8.63336 6.50741C8.52334 6.81396 8.48039 7.14056 8.5074 7.46514V8.59957H7.20388C7.14981 8.59957 7.09795 8.62105 7.05971 8.65929C7.02148 8.69752 7 8.74938 7 8.80345V10.4457C7 10.4998 7.02148 10.5516 7.05971 10.5899C7.09795 10.6281 7.14981 10.6496 7.20388 10.6496H8.5074V14.7961C8.5074 14.8229 8.51267 14.8494 8.52292 14.8741C8.53316 14.8989 8.54818 14.9214 8.56711 14.9403C8.58605 14.9592 8.60852 14.9742 8.63326 14.9845C8.65799 14.9947 8.6845 15 8.71128 15H10.4118C10.4386 15 10.4651 14.9947 10.4899 14.9845C10.5146 14.9742 10.5371 14.9592 10.556 14.9403C10.5749 14.9214 10.59 14.8989 10.6002 14.8741C10.6105 14.8494 10.6157 14.8229 10.6157 14.7961V10.649H12.1397C12.1938 10.649 12.2456 10.6276 12.2839 10.5893C12.3221 10.5511 12.3436 10.4992 12.3436 10.4452V8.80291C12.3436 8.77614 12.3383 8.74963 12.3281 8.72489C12.3178 8.70016 12.3028 8.67768 12.2839 8.65875C12.2649 8.63982 12.2425 8.6248 12.2177 8.61456C12.193 8.60431 12.1665 8.59904 12.1397 8.59904H10.6152V7.63638C10.6152 7.17404 10.7254 6.94074 11.3274 6.94074H12.2029C12.2569 6.94074 12.3088 6.91926 12.347 6.88102C12.3853 6.84279 12.4067 6.79093 12.4067 6.73686V5.20966C12.407 5.18271 12.4019 5.15597 12.3918 5.13098C12.3817 5.106 12.3667 5.08327 12.3478 5.06411C12.3288 5.04496 12.3062 5.02975 12.2814 5.01937C12.2565 5.00899 12.2298 5.00364 12.2029 5.00365Z"
                    />
                    <circle cx="10" cy="10" r="9.5" />
                  </svg>
                </div>
                <div
                  class="social__item"
                  @click.stop="copyRouteLink('telegram')"
                >
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      class="path"
                      d="M9.67143 13.1685C9.24856 13.5745 8.8356 13.9745 8.41809 14.3686C8.35113 14.4318 8.26758 14.4859 8.18241 14.5167C7.97781 14.5913 7.78231 14.5258 7.67304 14.3325C7.58868 14.1833 7.52226 14.0188 7.47299 13.8533C7.22071 13.009 6.97513 12.1623 6.73142 11.3153C6.70705 11.2305 6.66849 11.1883 6.58734 11.16C5.91327 10.9251 5.2408 10.6844 4.56779 10.4461C4.37309 10.3774 4.20411 10.2728 4.09431 10.0856C3.94273 9.8274 3.97299 9.54729 4.19152 9.34705C4.28632 9.26024 4.40014 9.18758 4.51691 9.13571C7.54021 7.792 10.5651 6.45162 13.5906 5.11207C13.68 5.07241 13.7737 5.03941 13.8688 5.01861C14.3265 4.91849 14.6771 5.23271 14.6187 5.7139C14.5694 6.11992 14.485 6.52151 14.4106 6.92393C14.0418 8.91856 13.6712 10.9132 13.3016 12.9075C13.2103 13.4006 13.1227 13.8943 13.0284 14.3866C12.9462 14.8167 12.4722 15.096 12.0244 14.9693C11.9042 14.9352 11.7858 14.8669 11.6862 14.7879C11.0472 14.2795 10.4135 13.7637 9.77802 13.2503C9.74696 13.2254 9.71455 13.2015 9.67143 13.1685ZM8.95237 11.9551C8.96576 11.9754 8.96951 11.9848 8.97593 11.9901C9.99066 12.8024 11.0041 13.6159 12.0212 14.4249C12.2496 14.6065 12.5121 14.4981 12.5694 14.2074C12.6192 13.9548 12.6637 13.7007 12.7105 13.4475C13.18 10.9143 13.6503 8.38107 14.1163 5.8473C14.1353 5.7444 14.1117 5.63291 14.108 5.52558C14.0008 5.54056 13.8835 5.53141 13.7877 5.57356C10.7603 6.90951 7.73517 8.25017 4.71 9.59166C4.64947 9.61856 4.59377 9.65822 4.5378 9.69539C4.47834 9.73477 4.4754 9.78857 4.5303 9.82906C4.61252 9.89008 4.69554 9.95941 4.78873 9.99325C5.43469 10.2279 6.0844 10.4517 6.73062 10.6863C6.83078 10.7227 6.90068 10.7088 6.98611 10.6494C8.67706 9.47823 10.3701 8.31035 12.063 7.14192C12.2295 7.02682 12.3902 6.8998 12.5662 6.80301C12.6358 6.76474 12.7542 6.76474 12.8244 6.80107C12.883 6.8313 12.932 6.93974 12.9331 7.01434C12.9342 7.08562 12.8793 7.16771 12.8297 7.22845C12.2641 7.92291 11.6945 8.61432 11.1262 9.30655C10.4023 10.1885 9.6784 11.0704 8.95237 11.9551ZM7.17652 11.1168C7.43496 12.0034 7.68884 12.8734 7.94246 13.7437C7.97352 13.7254 7.97834 13.7104 7.98156 13.6952C8.09752 13.1558 8.2092 12.6152 8.33266 12.0775C8.35837 11.9662 8.40978 11.8498 8.48049 11.763C9.15938 10.9259 9.84497 10.0945 10.5287 9.26163C10.7986 8.93298 11.0683 8.60405 11.3383 8.27541C11.3327 8.26875 11.3273 8.26182 11.3217 8.25516C9.94246 9.20699 8.56324 10.1594 7.17652 11.1168ZM9.28445 12.8565C9.1018 12.7148 8.93228 12.5833 8.74696 12.4394C8.66286 12.8351 8.58547 13.1976 8.50834 13.5604C8.51798 13.5651 8.52735 13.5698 8.53699 13.5745C8.78177 13.3391 9.02709 13.1036 9.28445 12.8565Z"
                      stroke-width="0.5"
                    />
                    <circle cx="10" cy="10" r="9.5" />
                  </svg>
                </div>
                <div class="social__item" @click.stop="copyRouteLink('email')">
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      class="path"
                      d="M9.99742 13.4999C8.74143 13.4999 7.48524 13.5001 6.22925 13.4999C5.62488 13.4997 5.08496 13.0265 5.0211 12.4247C4.99591 12.1864 5.00079 11.9444 5.0006 11.704C4.99943 10.2231 5.00021 8.74223 5.00099 7.26135C5.00118 6.55294 5.55517 6 6.26303 6C8.76213 6 11.2612 6 13.7605 6C14.3383 6 14.8783 6.43243 14.9712 6.99806C15.0099 7.23322 14.9983 7.47756 14.9985 7.7178C15.0003 9.22466 15.0003 10.7315 14.9981 12.2386C14.9972 12.9542 14.4442 13.4999 13.7267 13.4999C12.4834 13.4999 11.2405 13.4999 9.99742 13.4999ZM11.2185 9.74419C11.1972 9.76041 11.1841 9.76959 11.172 9.77994C10.8492 10.0567 10.5268 10.3339 10.2034 10.6098C10.0849 10.711 9.91873 10.7135 9.80176 10.6155C9.65999 10.4967 9.52076 10.3747 9.38017 10.2546C9.18314 10.0862 8.98591 9.91803 8.78107 9.74341C7.8795 10.7741 6.98124 11.8013 6.06796 12.8454C6.14763 12.8569 6.20992 12.8739 6.27241 12.8741C8.75783 12.8755 11.2435 12.8755 13.7289 12.8741C13.7912 12.8741 13.8533 12.8569 13.932 12.8454C13.0193 11.8024 12.122 10.777 11.2185 9.74419ZM6.1445 6.65724C7.42998 7.7596 8.71214 8.85883 9.99957 9.96275C11.2858 8.86 12.5686 7.76038 13.8542 6.65782C13.7488 6.61231 6.25327 6.61173 6.1445 6.65724ZM14.3502 12.3733C14.3598 12.3149 14.3731 12.2722 14.3731 12.2294C14.3741 10.5731 14.3743 8.91684 14.3727 7.26057C14.3727 7.20021 14.353 7.13967 14.3401 7.06623C13.4467 7.83225 12.5707 8.58324 11.6924 9.33638C12.5789 10.3495 13.459 11.355 14.3502 12.3733ZM5.62566 12.3565C5.63797 12.3571 5.65027 12.3577 5.66257 12.3585C6.54208 11.3522 7.42158 10.346 8.30539 9.33481C7.42529 8.57992 6.54891 7.82874 5.66042 7.0672C5.64734 7.134 5.62703 7.18986 5.62703 7.24572C5.62547 8.94926 5.62566 10.6528 5.62566 12.3565Z"
                    />
                    <path
                      d="M19.5 10C19.5 15.2467 15.2467 19.5 10 19.5C4.75329 19.5 0.5 15.2467 0.5 10C0.5 4.7533 4.7533 0.5 10 0.5C15.2467 0.5 19.5 4.75329 19.5 10Z"
                    />
                  </svg>
                </div>
                <div
                  class="social__item"
                  @click.stop="copyRouteLink('whatsapp')"
                >
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M19.5 10C19.5 15.2467 15.2467 19.5 10 19.5C4.75329 19.5 0.5 15.2467 0.5 10C0.5 4.7533 4.7533 0.5 10 0.5C15.2467 0.5 19.5 4.75329 19.5 10Z"
                    />
                    <path
                      class="path"
                      d="M5 15.004C5.21383 14.2075 5.42641 13.4266 5.6296 12.6432C5.65058 12.5558 5.64133 12.4639 5.60334 12.3824C4.03684 9.42199 5.69619 5.83193 8.96613 5.11292C11.6715 4.51896 14.4097 6.33212 14.912 9.04904C15.416 11.7747 13.7072 14.3422 10.9991 14.9062C9.87177 15.1409 8.78731 14.9793 7.751 14.4745C7.66491 14.4339 7.56819 14.4215 7.47465 14.4391C6.66967 14.6217 5.86719 14.8143 5.06409 15.0034C5.04278 15.0055 5.02134 15.0057 5 15.004ZM6.40676 13.6473C6.81316 13.5516 7.1883 13.47 7.56062 13.3728C7.62372 13.3535 7.69023 13.3479 7.75566 13.3565C7.82109 13.3652 7.8839 13.3878 7.93982 13.4228C8.81795 13.9355 9.75923 14.1106 10.7615 13.9214C12.8738 13.5222 14.3518 11.4677 13.9254 9.26349C13.484 6.97891 11.3076 5.59935 9.04053 6.13329C7.02886 6.60722 5.68775 8.69047 6.07914 10.7134C6.18294 11.2447 6.38433 11.7522 6.67311 12.2102C6.70439 12.2567 6.72438 12.3099 6.73149 12.3656C6.7386 12.4212 6.73263 12.4777 6.71406 12.5306C6.60902 12.8929 6.51399 13.2578 6.40676 13.6473Z"
                    />
                    <path
                      class="path"
                      d="M7.45117 8.88976C7.45805 8.46992 7.62499 8.12917 7.91415 7.84156C8.04951 7.70683 8.41777 7.63336 8.5869 7.72152C8.65842 7.76245 8.7152 7.82492 8.74914 7.90002C8.89274 8.22222 9.0282 8.54797 9.15554 8.87725C9.16755 8.91063 9.17265 8.9461 9.17056 8.98151C9.16846 9.01692 9.15921 9.05153 9.14335 9.08326C9.04842 9.23135 8.94334 9.37268 8.82886 9.50623C8.75852 9.59032 8.74539 9.66566 8.80135 9.75976C9.21087 10.4506 9.78296 10.9493 10.5332 11.244C10.6339 11.2834 10.7045 11.2519 10.7661 11.1765C10.8912 11.0237 11.0187 10.872 11.1384 10.7148C11.2119 10.6188 11.2932 10.5804 11.4073 10.6345C11.754 10.7992 12.1032 10.9596 12.4455 11.1346C12.4949 11.16 12.5377 11.2497 12.5393 11.3106C12.553 11.9046 12.2057 12.2532 11.6089 12.3763C11.3854 12.4226 11.1316 12.3838 10.9027 12.3332C9.72794 12.0737 8.83636 11.3932 8.14361 10.4297C7.89508 10.0836 7.6403 9.73975 7.53214 9.31585C7.49556 9.17705 7.47743 9.03168 7.45117 8.88976Z"
                    />
                  </svg>
                </div>
                <div class="social__item" @click.stop="copyRouteLink('vk')">
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M19.5 10C19.5 15.2467 15.2467 19.5 10 19.5C4.75329 19.5 0.5 15.2467 0.5 10C0.5 4.7533 4.7533 0.5 10 0.5C15.2467 0.5 19.5 4.75329 19.5 10Z"
                    />
                    <path
                      class="path"
                      d="M8.15523 7.70243C8.22383 7.49751 8.37489 7.39576 8.55441 7.36374C8.83282 7.31394 9.11744 7.27089 9.39913 7.27303C9.7881 7.27552 10.1793 7.30433 10.5642 7.35698C10.8167 7.39149 10.9258 7.54233 10.9273 7.79172C10.9302 8.27591 10.9149 8.76045 10.9152 9.24499C10.9156 9.4741 10.9061 9.70855 10.9517 9.93054C11.0203 10.2628 11.2447 10.3269 11.4706 10.0728C11.7231 9.7893 11.9643 9.48762 12.1569 9.16388C12.4102 8.73839 12.6171 8.28587 12.8331 7.83975C12.9455 7.60779 12.9958 7.56297 13.2545 7.55977C13.8365 7.55265 14.4185 7.54447 15.0005 7.53735C15.0549 7.53664 15.1107 7.53415 15.164 7.54376C15.4322 7.5925 15.5073 7.7163 15.4209 7.97422C15.2581 8.45912 14.944 8.85828 14.6415 9.26243C14.3988 9.58652 14.1394 9.89852 13.8964 10.2223C13.5716 10.6545 13.6136 10.852 14.0109 11.223C14.4171 11.6022 14.7965 12.0089 15.18 12.4109C15.2647 12.4998 15.3245 12.6147 15.3818 12.7247C15.5373 13.0231 15.415 13.2512 15.0695 13.2889C14.8232 13.3156 14.574 13.3198 14.3262 13.3259C14.0288 13.333 13.7314 13.3341 13.4337 13.3334C13.0925 13.3327 12.8141 13.1815 12.5791 12.9577C12.3711 12.7595 12.1854 12.54 11.9844 12.3351C11.8716 12.2202 11.7541 12.1071 11.6257 12.0096C11.4235 11.8563 11.2013 11.8918 11.1024 12.1231C11.0116 12.3355 10.9539 12.572 10.9368 12.8019C10.9083 13.1882 10.7988 13.2974 10.3927 13.3145C9.77569 13.3408 9.17582 13.2832 8.59857 13.0569C7.8458 12.762 7.26089 12.2611 6.76683 11.6478C5.92941 10.6079 5.29998 9.4492 4.73076 8.2567C4.66033 8.10906 4.60232 7.95466 4.55452 7.79884C4.52095 7.68997 4.58918 7.61491 4.69427 7.58609C4.78659 7.56083 4.88328 7.53949 4.97852 7.53878C5.43973 7.5338 5.90132 7.53629 6.3629 7.53664C6.59606 7.537 6.76464 7.62736 6.85988 7.84757C7.15617 8.53383 7.50682 9.19234 7.96001 9.79393C8.05598 9.92129 8.16472 10.0454 8.28878 10.1461C8.49311 10.3119 8.67264 10.2614 8.73759 10.0127C8.79524 9.79215 8.831 9.56126 8.83793 9.33358C8.84778 9.00379 8.8383 8.67151 8.80838 8.34279C8.77481 7.97245 8.56573 7.73836 8.15523 7.70243Z"
                    />
                  </svg>
                </div>
                <div class="social__item" @click.stop="copyRouteLink('viber')">
                  <svg
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M19.5 10C19.5 15.2467 15.2467 19.5 10 19.5C4.75329 19.5 0.5 15.2467 0.5 10C0.5 4.7533 4.7533 0.5 10 0.5C15.2467 0.5 19.5 4.75329 19.5 10Z"
                    />
                    <path
                      class="path"
                      d="M9.57176 5H10.3855C10.4186 5.01099 10.4526 5.0193 10.4871 5.02484C10.6753 5.0414 10.8637 5.05168 11.0513 5.07052C11.6465 5.13008 12.2327 5.25876 12.7981 5.45398C13.6961 5.76234 14.3114 6.35193 14.6369 7.24618C14.863 7.87749 14.9845 8.5415 14.9966 9.21198C15.0095 9.74219 14.9832 10.2741 14.9592 10.8043C14.9384 11.2634 14.8778 11.718 14.7445 12.1611C14.4807 13.0374 13.9736 13.7138 13.1268 14.1026C12.6908 14.3025 12.2277 14.4244 11.7563 14.4967C11.328 14.562 10.8949 14.6109 10.462 14.6323C10.0677 14.6525 9.67112 14.6323 9.27596 14.6197C9.19487 14.6171 9.14433 14.6303 9.09266 14.6917C8.84996 14.9818 8.60499 15.2699 8.35773 15.5562C8.21497 15.7212 8.06507 15.878 7.85807 15.9642H7.751C7.59054 15.9117 7.4809 15.8095 7.44578 15.6407C7.4289 15.5643 7.41934 15.4865 7.41723 15.4083C7.41437 15.0871 7.41095 14.7659 7.41894 14.445C7.4218 14.3308 7.39039 14.2799 7.27618 14.2431C6.40592 13.9619 5.78834 13.3977 5.41802 12.5614C5.12651 11.8987 5.01858 11.1958 5.00345 10.482C4.9906 9.91636 5.01601 9.34903 5.04085 8.78313C5.06319 8.31689 5.15064 7.85607 5.30067 7.41407C5.55279 6.66058 5.9745 6.04357 6.70629 5.67383C7.43807 5.30408 8.22982 5.1322 9.04212 5.05054C9.21857 5.03255 9.39531 5.01685 9.57176 5ZM7.68505 14.5489H7.68048C7.68048 14.827 7.68048 15.1053 7.68048 15.3838C7.67897 15.423 7.68165 15.4622 7.68847 15.5008C7.7156 15.6279 7.79668 15.6587 7.8969 15.5773C7.94585 15.5358 7.99069 15.4896 8.03081 15.4394C8.44215 14.9464 8.85234 14.4524 9.2614 13.9573C9.28238 13.9274 9.31087 13.9035 9.34399 13.8881C9.37712 13.8727 9.41372 13.8662 9.45012 13.8694C10.3624 13.9049 11.2752 13.8141 12.1626 13.5996C13.1873 13.3494 13.8186 12.731 14.0861 11.7228C14.2209 11.2163 14.2443 10.695 14.264 10.1773C14.2774 9.82156 14.2617 9.46352 14.2471 9.10805C14.2275 8.61314 14.1404 8.12323 13.9882 7.6519C13.7489 6.90955 13.2744 6.40447 12.5269 6.15121C11.8518 5.9221 11.1466 5.79395 10.434 5.7709C9.96178 5.75491 9.48667 5.7789 9.01442 5.80973C8.50477 5.84314 8.01082 5.96506 7.52972 6.14436C6.8933 6.3822 6.4062 6.78164 6.1224 7.41035C5.89027 7.92429 5.78834 8.46677 5.75294 9.02439C5.73552 9.29792 5.73666 9.57288 5.72638 9.84726C5.70468 10.4294 5.72638 11.0088 5.85972 11.5784C6.08442 12.5471 6.62177 13.2461 7.59254 13.5633C7.66449 13.5867 7.68562 13.6218 7.68505 13.6932C7.68333 13.9779 7.68505 14.2634 7.68505 14.5489Z"
                    />
                    <path
                      class="path"
                      d="M11.5416 12.7866C11.4291 12.7489 11.2978 12.7158 11.1761 12.6621C10.0486 12.1631 9.03646 11.5106 8.29925 10.4922C7.90295 9.94543 7.61 9.3447 7.35503 8.72198C7.33342 8.66158 7.30835 8.60248 7.27994 8.54496C7.15774 8.3234 7.19571 8.11097 7.31763 7.90682C7.4641 7.66156 7.67567 7.4814 7.9235 7.34692C8.12194 7.23928 8.28611 7.27668 8.42059 7.46113C8.63388 7.75493 8.84659 8.04987 9.04302 8.35509C9.21205 8.61834 9.16808 8.82134 8.93139 9.02178C8.92853 9.02406 8.92596 9.02663 8.92311 9.02863C8.57306 9.28388 8.5919 9.41922 8.74865 9.7764C9.03246 10.424 9.46245 10.9336 10.1326 11.204C10.2484 11.2541 10.3732 11.2804 10.4995 11.2814C10.574 11.2794 10.6542 11.2054 10.7176 11.1483C10.781 11.0912 10.8241 11.0147 10.8772 10.9485C11.0083 10.7834 11.1978 10.7275 11.3817 10.8257C11.7634 11.0295 12.1127 11.2889 12.4181 11.5954C12.4629 11.6401 12.4931 11.6973 12.5048 11.7595C12.5165 11.8216 12.5092 11.8859 12.4838 11.9438C12.3451 12.2864 12.1241 12.5659 11.7789 12.7255C11.7129 12.7561 11.637 12.7629 11.5416 12.7866Z"
                    />
                    <path
                      class="path"
                      d="M10.0208 6.9778C11.1782 7.02063 12.2141 7.69474 12.5567 9.00242C12.6335 9.29565 12.6481 9.60544 12.6861 9.90837C12.6978 10.0029 12.6444 10.0674 12.5679 10.0663C12.4697 10.0648 12.4482 10.0009 12.4457 9.91494C12.428 9.33648 12.3135 8.78343 11.9866 8.29348C11.5942 7.70559 11.0395 7.36982 10.3457 7.26247C10.2195 7.24277 10.0913 7.23163 9.96365 7.22421C9.87799 7.21935 9.81375 7.19566 9.81546 7.09829C9.81718 7.00093 9.88085 6.97295 9.96736 6.97752C9.98506 6.97838 10.003 6.97752 10.0208 6.9778Z"
                    />
                    <path
                      class="path"
                      d="M11.9824 9.5832C11.9824 9.60461 11.9824 9.62603 11.9824 9.64744C11.977 9.72482 11.9376 9.78392 11.8596 9.78306C11.7768 9.78306 11.7394 9.72596 11.7397 9.6383C11.7397 9.26713 11.6612 8.91651 11.4425 8.61043C11.177 8.23726 10.8009 8.04682 10.3575 7.97144C10.3016 7.96123 10.2452 7.95399 10.1885 7.94974C10.1005 7.94432 10.044 7.90834 10.0492 7.81269C10.0543 7.71705 10.1174 7.69849 10.1985 7.70334C10.9597 7.75102 11.7037 8.19072 11.9167 9.09896C11.9541 9.25742 11.9673 9.42131 11.9918 9.58291L11.9824 9.5832Z"
                    />
                    <path
                      class="path"
                      d="M11.3132 9.43347C11.2692 9.47031 11.2304 9.52655 11.1804 9.53883C11.1099 9.55625 11.0639 9.50857 11.0551 9.42976C11.0467 9.34492 11.0329 9.26071 11.0137 9.17765C10.9437 8.89213 10.7367 8.72082 10.4455 8.69683C10.4102 8.69474 10.3752 8.68929 10.341 8.68056C10.2705 8.66086 10.2351 8.6029 10.2619 8.54265C10.2819 8.49754 10.343 8.44072 10.3858 8.44044C10.8638 8.43844 11.2395 8.79248 11.2789 9.2713C11.2826 9.31755 11.2872 9.36352 11.2912 9.40949L11.3132 9.43347Z"
                    />
                  </svg>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'
import { required } from 'vuelidate/lib/validators'
export default {
  props: {
    resetAction: {
      type: Function
    },
    isbuild: {
      type: Boolean
    },
    type: {
      type: String
    }
  },
  data () {
    return {
      isShareActive: false,
      isSendActive: false,

      cstp: 'route',

      stepList: {
        first: 'route',
        second: 'direction',
        third: 'go'
      },
      isFieldError: false,
      locationFromKey: 0,
      locationToKey: 0,
      locationVariant: '',
      settingsIsOpen: false
    }
  },
  computed: {
    userCanAct () {
      return this.isWay || this.IS_AUTHORIZATION
    },

    isWay () {
      return this.type === 'way'
    },
    showRouteBody () {
      return this.isMobile ? this.MAP_CHOISE_OPTION !== 'map' : true
    },

    currentStep: {
      get () {
        if (this.isWay) {
          return 'go'
        }
        return this.cstp
      },
      set (value) {
        if (value === 'direction') {
          this.$parent.isCompactHeight = true
        } else {
          this.$parent.isCompactHeight = false
        }

        this.cstp = value
      }
    },
    selectedCatering: {
      get () {
        return this.SELECTED_CATERING
      }
    },
    fromAddress: {
      get () {
        return this.GMAP_ROUTE.from
      },
      set (value) {
        this.$store.commit('SET_GMAP_ROUTE', { from: value })
      }
    },
    toAddress: {
      get () {
        return this.GMAP_ROUTE.to
      },
      set (value) {
        this.$store.commit('SET_GMAP_ROUTE', { to: value })
      }
    },
    movementType: {
      get () {
        return this.GMAP_ROUTE.movementType
      },
      set (value) {
        this.$store.commit('SET_GMAP_ROUTE', { movementType: value })
      }
    },
    ...mapGetters([
      'GMAP_API_KEY',
      'IS_AUTHORIZATION',
      'MAP_CHOISE_OPTION',
      'SELECTED_CATERING',
      'GMAP_ROUTE',
      'CURRENT_CATERING',
      'GMAP_ROUTE_DURATION',
      'GMAP_AUTOCOMPLETE_SERVICE',
      'CATERING_LIST'
    ])
  },
  validations: {
    fromAddress: {
      required
    },
    toAddress: {
      required
    },
    movementType: {
      required
    }
  },
  mounted () {
    this.wait(this.reloadAutocompletesServices)
    this.movementType = this.GMAP_ROUTE.movementType || 'walking'

    const vm = this
    if (
      this.$refs.sharesendclick &&
      this.$refs.sharesendclick.closest('.wrapper')
    ) {
      this.$refs.sharesendclick
        .closest('.wrapper')
        .addEventListener('click', () => {
          if (vm.settingsIsOpen) {
            vm.settingsIsOpen = false
          }
          if (vm.isShareActive) {
            vm.isShareActive = false
          }
          if (vm.isSendActive) {
            vm.isSendActive = false
          }
        })
    }
  },
  methods: {
    clearFromAddress () {
      this.fromAddress = ''
      this.$parent.$refs.mapView.resetDirections()
      if (this.isMobile) {
        this.prevStep()
      }
    },

    clearToAddress () {
      this.toAddress = ''
      this.$parent.$refs.mapView.resetDirections()
      if (this.isMobile) {
        this.prevStep()
      }
    },

    showTopCardPC (top) {
      if (this.$parent.showTopCardPC) {
        this.$parent.showTopCardPC(top)
      } else {
        throw new Error('FilterRoute: No showTopCardPC on parent')
      }
    },

    reloadAutocompletesServices () {
      if (window.google && window.google.maps) {
        const ac = new window.google.maps.places.AutocompleteService()
        const ge = new window.google.maps.Geocoder()

        this.$refs.locationFrom.$service = ac
        this.$refs.locationFrom.$geocoder = ge
        this.$refs.locationFrom.loaded = true
        this.$refs.locationFrom.$emit('loaded')

        this.$refs.locationTo.$service = ac
        this.$refs.locationTo.$geocoder = ge
        this.$refs.locationTo.loaded = true
        this.$refs.locationTo.$emit('loaded')
        return
      }
      return false
    },

    chooseLocationVariant (option) {
      if (this.userCanAct) {
        if (option === 'map') {
          this.fromAddress = ''
          this.$store.commit('SET_MAP_CHOISE_OPTION', option)
        } else {
          this.$parent &&
            this.$parent.$refs &&
            this.$parent.$refs.mapView &&
            this.$parent.$refs.mapView.getUserGeolocation()
          this.$parent &&
            this.$parent.$refs &&
            this.$parent.$refs.mapViewWay &&
            this.$parent.$refs.mapViewWay.getUserGeolocation()
        }

        this.settingsIsOpen = false
        if (this.isMobile && !this.isWay) {
          this.prevStep()
        }
      } else {
        this.loginUserTypes()
      }
    },
    toggleSettings () {
      this.settingsIsOpen = !this.settingsIsOpen
    },
    selectMovementType (value) {
      if (this.userCanAct || this.isbuild === true) {
        this.movementType = value
        if (this.isMobile && !this.isWay) {
          this.prevStep()
        }
      } else {
        this.loginUserTypes()
      }
    },
    changeLocations () {
      this.$store.commit('SET_GMAP_REFRESH_LOCATIONS')
      if (this.isMobile && this.isWay) {
        this.prevStep()
      }
    },
    goToBack () {
      if (this.isWay) {
        const prevpath = this.$nuxt.context.from.path
        if (prevpath && !~prevpath.indexOf('way')) {
          // Переброс на предыдущую страницу
          this.$router.back()
        } else {
          // Переброс на главную
          this.resetAction()
          this.$store.commit('RESET_GMAP_ROUTE_DATA')
          this.$store.commit('RESET_CHOISE_OPTION')
          this.$router.push(this.localePath('index'))
        }
        return
      }

      if (this.currentStep === this.stepList.first) {
        this.resetAction()
        this.$store.commit('RESET_GMAP_ROUTE_DATA')
        this.$store.commit('RESET_CHOISE_OPTION')
      } else {
        this.prevStep()
      }
    },
    nextStep () {
      if (
        this.GMAP_ROUTE_DURATION.transit ||
        this.GMAP_ROUTE_DURATION.driving ||
        this.GMAP_ROUTE_DURATION.walking
      ) {
        if (!this.userCanAct) {
          this.loginUserTypes()
        } else {
          this.$v.$touch()
          this.isFieldError = false

          if (this.$v.$invalid) {
            this.isFieldError = true
          } else if (this.currentStep === this.stepList.first) {
            this.selectStep(this.stepList.second)
          } else if (this.currentStep === this.stepList.second) {
            this.selectStep(this.stepList.third)
          }
        }
      }
    },
    prevStep () {
      if (this.currentStep === this.stepList.third) {
        this.selectStep(this.stepList.second)
      } else if (this.currentStep === this.stepList.second) {
        this.selectStep(this.stepList.first)
      }
    },
    selectStep (n) {
      this.currentStep = n
    },
    copyRouteLink (type) {
      const vm = this
      let way = {
        catering: vm.CURRENT_CATERING.id,
        to: `${vm.CURRENT_CATERING.address.city}, ${vm.CURRENT_CATERING.address.street}, ${vm.CURRENT_CATERING.address.building}`
      }
      way = JSON.stringify(way)
      way = this.b64e(way)

      let href =
        window.location.origin +
        this.localePath({ path: '/way', query: { q: way } })

      navigator.clipboard
        .writeText(href)
        .then(() => {
          this.$store.commit('SET_SUCCESS_NOTIFY', this.$t('linkCopied'))
          if (type) {
            requestAnimationFrame(() => {
              switch (type) {
                case 'facebook':
                  href = 'https://www.facebook.com/'
                  break
                case 'telegram':
                  href = 'https://web.telegram.org/'
                  break
                case 'email':
                  href = 'http://gmail.com/'
                  break
                case 'whatsapp':
                  href = 'https://web.whatsapp.com/'
                  break
                case 'vk':
                  href = 'https://vk.com'
                  break
                case 'viber':
                  href = 'https://www.viber.com/'
                  break
              }
              Object.assign(document.createElement('a'), {
                target: '_blank',
                href
              }).click()
            })
          }
        })
        .catch((err) => {
          console.error('copyRouteLink', err)
          this.$store.commit('SET_ERROR_NOTIFY', this.$t('linkCopiedError'))
        })

      this.isShareActive = false
      this.isSendActive = false
    }
  }
}
</script>

<style>
.route .autocomplete-list-item-label {
  font-size: 14px !important;
}

.route .disabledAutocomplete .form-group.input-field {
  width: 100% !important;
}
</style>

<style lang="scss" scoped>
@import '~/assets/styles/abstract/var';
@import '~/assets/styles/modificator';

.social__list {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px;
  flex-wrap: wrap;
  @media screen and (min-width: 1400px) {
    flex-wrap: nowrap;
  }
  .social__item {
    @media screen and (min-width: 1400px) {
      max-width: 22px;
      max-height: 22px;
    }
    @media screen and (max-width: 1400px) {
      text-align: center;
      flex: 0 0 33.33% !important;
    }
    transition: all 0.3s ease;
    svg {
      width: 22px;
      height: 22px;
      max-width: 22px;
      max-height: 22px;
      cursor: pointer;
      stroke: #a7a7a7;
      transition: all 0.3s ease;
      .path {
        fill: #a7a7a7;
      }
    }
    &:hover {
      box-shadow: 0px 0px 20px rgba(33, 188, 149, 0.212);
      svg {
        stroke: #21bc96;
        .path {
          fill: #21bc96;
        }
      }
    }
  }
}
.btn-steps {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 90%;
  padding: 14px;
  border: 1px solid $c-line;
  color: #5c5c5c;
  border-radius: 4px;
  img {
    width: 14px;
    height: 14px;
  }
}
.btn-send {
  position: relative;

  .icon {
    display: block;

    img {
      width: 20px;
    }
  }

  &-text {
    font-size: 14px;
    margin-top: 7px;
  }

  &-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    flex: 0 0 15px;
    width: 15px;
    height: 15px;

    @media screen and (min-width: 992px) {
      display: none;
    }

    svg {
      width: 100%;
      height: 100%;
      fill: $c-light;
    }
  }
}
.send_container,
.share_container {
  position: relative;
  display: block;
  width: 100%;
  margin-bottom: 2em;
}

.abcblock {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;

  @media screen and (max-width: 1366px) {
    flex-direction: column;
  }
}

.field-error {
  max-width: 230px;
  font-size: 14px;
  padding: 1.5rem 1.5rem 0;
  line-height: 2rem;
  color: #b4476c;
  @media screen and (max-width: 991px) {
    max-width: 100%;
    font-size: 16px;
    display: flex;
    justify-content: center;
  }
}
.route {
  position: relative;
  overflow: hidden;
  flex-direction: column;
  display: flex;
  width: 100%;
  height: 100%;

  @media screen and (max-width: 991px) {
    position: initial;
    overflow: visible;
  }

  &.second {
    grid-template-rows: 100%;

    // .form-movement-icon{

    //   @media screen and (max-width: 991px) {
    //     width: 32px;
    //     height: 32px;
    //   }
    // }
  }

  &_body {
    display: flex;
    flex-direction: column;
    grid-template-rows: auto 1fr;
    // grid-row-gap: 15px;
    padding-top: 22px;
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;

    @media screen and (max-width: 991px) {
      padding-bottom: 1rem;
      padding-top: 3px;
      margin-top: 3rem;
    }
  }

  &_form {
    display: flex;
    flex-direction: column;
    width: 100%;
    padding: 0 20px;
    margin: 0 0 2rem;
    height: auto;

    &.form {
      display: flex;
      flex-direction: column;
      grid-row-gap: 0;
      ul {
        margin: 15px 0;
      }

      @media screen and (max-width: 991px) {
        padding: 0;
        margin: 0;
      }
    }

    @media screen and (min-width: 992px) {
      margin-top: 0;
      margin-bottom: 0;
      padding: 5px 10px 0px 10px;
    }

    // & > * {
    //   margin-top: 5px;
    // }
  }

  &-title {
    font-family: $ff-roboto;
    font-size: 24px;
    margin-top: 3rem;
    text-align: center;
    color: $c-green;

    @media screen and (min-width: 992px) {
      display: none;
    }

    &.hide {
      display: none;
    }
  }

  &-back {
    z-index: 3;
    position: absolute;
    padding: 2px 0 0 0.5rem;
    font-family: $ff-gilroy;
    font-size: 14px;
    color: #c4c4c4;
    background-color: #fff;
    width: 100%;

    @media screen and (min-width: 992px) {
      display: none;
      &.show {
        display: block;
      }
    }

    @media screen and (max-width: 991px) {
      top: 10px;
      left: 10px;
      margin: 0;
    }

    &-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 25px;
      height: 10px;
      overflow: hidden;

      svg {
        width: 100%;
        height: 100%;
        fill: #c4c4c4;
        transform: scale(6, 5);
      }
    }
  }

  &_tops {
    overflow-y: auto;
  }

  &_map {
    @media screen and (min-width: 992px) {
      display: none;
    }
  }

  &_share {
    position: absolute;
    bottom: 0;
    left: 0;
    z-index: 10;
    background-color: $light;
    width: 100vw;
    padding: 10px 15px;

    @media screen and (min-width: 992px) {
      position: static;
      width: auto;
    }

    &-detail {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: $ff-gilroy;
      font-size: 16px;

      @media screen and (min-width: 992px) {
        justify-content: center;
      }
    }

    &-text {
      font-family: $ff-gilroy;
      font-size: 16px;

      @media screen and (min-width: 992px) {
        font-size: 14px;
        text-decoration: underline;
      }

      &.mobile {
        @media screen and (min-width: 992px) {
          display: none;
        }
      }
      &.desktop {
        cursor: pointer;
        @media screen and (max-width: 991px) {
          display: none;
        }
      }
    }

    &-icon {
      width: 25px;
      height: 25px;
      box-shadow: 0px 3px 6px #11100026;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
      margin-left: 0;
      margin-top: 3px;

      @media screen and (min-width: 992px) {
        width: 30px;
        height: 30px;
      }
      @media screen and (min-width: 1363px) {
        margin-left: 15px;
      }
    }
  }
}

.form {
  display: grid;
  grid-template-rows: repeat(3, auto);
  grid-row-gap: 10px;

  @media screen and (max-width: 991px) {
    height: auto;
  }

  @media screen and (min-width: 992px) {
    grid-row-gap: 5px;
  }

  &_group {
    position: relative;
    display: grid;
    grid-template-columns: auto 1fr auto;
    grid-template-rows: repeat(2, 35px);
    grid-template-areas: 'icon input-from menu' 'icon input-to change';
    grid-gap: 10px 5px;
    width: 100%;
  }

  &-icon {
    grid-area: icon;
    align-self: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    width: 30px;
    height: 70%;

    &-circle {
      position: absolute;
      top: 15px;
      display: block;
      width: 14px;
      height: 14px;
      border: 1px solid #000;
      border-radius: 100%;
    }
    &-dots {
      position: absolute;
      top: 30px;
      border-left: 2px dotted #000;
      height: 29%;
      width: 1px;
    }
    img {
      position: absolute;
      bottom: 0;
      width: 35px;
      height: 35px;
    }
  }

  &-address {
    position: relative;
    background: #ffffff 0% 0% no-repeat padding-box;
    box-shadow: 0px 3px 6px #11100029;
    border: 1px solid #e2e2e2;
    border-radius: 7px;

    @media screen and (max-width: 991px) {
      height: 38px;
    }

    @media screen and (min-width: 992px) {
      background: #ffffff 0% 0% no-repeat padding-box;
      box-shadow: none;
      border: 1px solid #e2e2e2;
      border-radius: 0;
    }

    &.from {
      grid-area: input-from;
    }
    &.to {
      grid-area: input-to;
    }

    &.error /deep/ {
      .autocomplete-field {
        border: {
          width: 1px;
          style: solid;
          color: $c-error;
        }
        @media screen and (max-width: 991px) {
          padding-left: 12px;
        }
      }
    }

    &-clear {
      position: absolute;
      top: 50%;
      right: 0;
      width: 12px;
      height: 12px;
      object-fit: cover;
      cursor: pointer;
      transform: translate(-50%, -50%);

      @media screen and (max-width: 991px) {
        flex: 0 0 15px;
        width: 15px;
        height: 15px;
      }
    }

    & /deep/ {
      .autocomplete-field {
        height: 100%;
        display: flex;
        align-items: center;

        input {
          width: 100%;
          height: 100%;
          font-size: 14px;

          @media screen and (max-width: 991px) {
            padding: 2px 2px 2px 16px;
          }
          @media screen and (min-width: 992px) {
            font-size: 14px;
            padding: 2px 5px;
          }
        }
      }

      .form-group.input-field {
        width: 91%;
      }

      .form-group .form-group-inner {
        height: 100%;
      }

      .form-group .form-group-inner .form-control {
        padding-left: 5px;
        height: 100%;
        width: 100%;
      }
    }
  }

  &_menu {
    grid-area: menu;
    z-index: 2;
    margin-left: -5px;

    @media screen and (max-width: 991px) {
      padding-left: 5px;
      margin-top: -3px;
      width: 18px;
    }

    &_settings {
      position: absolute;
      top: 55px;
      right: 0px;
      display: none;
      flex-direction: column;
      padding: 0;
      width: 50vw;
      border-radius: 5px;
      box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
      background-color: $bgc-light;
      border: 1px solid $c-line;
      z-index: 888;

      @media screen and (min-width: 992px) {
        top: 20px;
        width: 89%;
      }

      &.share {
        position: absolute;
        bottom: -10rem;
        right: 11%;
        width: 80%;
        top: auto;
        .form_menu-item {
          &:hover {
            background-color: #f3bd44;
          }
        }
      }
      &.send {
        position: absolute;
        bottom: -1rem;
        right: 11%;
        width: 80%;
        top: auto;
        bottom: -90px;
        @media screen and (max-width: 1400px) {
          bottom: -145px;
        }
      }

      &.open {
        display: flex;
      }
    }

    &_share {
      position: absolute;
      top: 38px;
      right: -20px;
      display: none;
      flex-direction: column;
      padding: 0;
      width: 50vw;
      box-shadow: 0px 6px 9px #11100029;
      background-color: $bgc-light;
      border: 1px solid $c-line;

      @media screen and (min-width: 992px) {
        width: 270px;
      }

      &.open {
        display: flex;
      }
    }

    &-item {
      display: flex;
      align-items: center;
      font-family: $ff-gilroy;
      font-size: 14px;
      padding: 10px;
      cursor: pointer;
      border-bottom: 1px solid $c-line;
      transition: all 0.3s ease;
      @media screen and (min-width: 992px) {
        text-align: left;
      }
      svg {
        flex-shrink: 0;
      }
      .send_svg,
      .share_svg,
      .shareMob_svg {
        margin-right: 5px;
        cursor: pointer;
        width: 22px;
        height: 22px;
        stroke: #a7a7a7;
        transition: all 0.3s ease;
        .path {
          fill: #a2a2a2;
        }
      }

      &:hover {
        color: #21bc96;
        .send_svg {
          stroke: #21bc96 !important;
        }
      }
      .share &:hover {
        color: white;
        .share_svg,
        .shareMob_svg {
          stroke: white;
          .path {
            fill: white;
          }
        }
      }
    }

    &-dots {
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 0 0 15px;
      width: 15px;
      height: 100%;
      cursor: pointer;
      overflow: hidden;

      @media screen and (max-width: 991px) {
        width: 18px;
      }

      svg {
        width: 100%;
        height: 100%;
        fill: #5d5d5d;
        transform-origin: center;
        transform: scale(3, 3);
      }
    }
  }

  &-change {
    grid-area: change;
    margin-left: -10px;
    margin-right: -10px;
    width: 32px;
    height: 100%;
    cursor: pointer;

    @media screen and (max-width: 991px) {
      margin: -5px -15px 0 -10px;
      width: 46px;
      height: 46px;
    }
  }

  &_movements {
    display: flex;
    justify-content: space-around;
    // align-items: center;
    width: 100%;
    @media screen and (min-width: 992px) {
      height: 56px;
    }
  }

  &-movement {
    width: initial;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;

    &.error &-icon {
      border-color: $c-error;
    }

    &.active &-icon {
      border-color: $c-green;
      border-width: 1px;
    }

    &-icon {
      position: relative;
      box-shadow: 0px 3px 6px #11100029;
      border: 1px solid #e2e2e2;
      border-radius: 7px;
      padding: 5px;
      width: 32px;
      height: 32px;
      img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      @media screen and (max-width: 991px) {
        padding: 20%;
        width: 48px;
        height: 48px;
      }

      @media screen and (min-width: 992px) {
        box-shadow: none;
      }
    }
    &.disabled &-icon {
      cursor: not-allowed;
      border: none !important;
      background-color: #cecece !important;
      img {
        filter: brightness(10);
      }
    }

    &-txt {
      position: relative;
      width: 100%;
      min-width: 70px;
      text-align: center;
      margin-top: 3px;
      font-family: $ff-gilroy;
      font-size: 14px;
    }

    &.active &-txt {
      color: $c-green;
    }
  }

  &-btn {
    position: relative;
    justify-self: center;
    align-self: center;
    align-items: center;
    margin-bottom: 10px;
    &-disabled {
      justify-self: center;
      align-self: center;
      align-items: center;

      @media screen and (max-width: 991px) {
        margin-top: 0 !important;
        box-shadow: none !important;
        display: flex;
        text-align: center;
        justify-content: center;
      }
    }
    @media screen and (max-width: 991px) {
      margin-top: 0 !important;
      box-shadow: none !important;
      display: flex;
      justify-content: center;
    }

    &.hide {
      display: none;
    }
  }
}
</style>

<style lang="scss" scoped>
@import '~/assets/styles/abstract/var';

/deep/ .top {
  display: grid;
  grid-template-columns: 1fr 15px;
  grid-template-rows: repeat(3, auto);
  grid-template-areas: 'header arrow' 'article arrow' 'footer arrow';
  grid-gap: 5px;
  padding: 7px 4px 7px 15px;
  width: 100%;
  cursor: pointer;

  &:not(:first-of-type) {
    border-top: {
      width: 1px;
      style: solid;
      color: $c-line;
    }
  }

  &_list {
    display: flex;
    flex-direction: column;
    border: {
      width: 1px;
      style: solid;
      color: #e2e2e2;
      bottom-right-radius: $br-block-desktop;
    }
    width: 100%;
    height: 100%;
    background-color: $light;
    overflow-y: auto;
    overflow-x: hidden;

    @media screen and (max-width: 991px) {
      border: none;
    }
  }

  &_header,
  &_article,
  &_footer {
    display: flex;
    align-items: center;
    width: 100%;
  }

  &_header {
    grid-area: header;

    &-icon {
      flex: 0 0 15px;
      width: 15px;
      height: 15px;
    }

    &-title {
      margin-left: 5px;
      font-family: $ff-roboto;
      font-size: 12px;

      @media screen and (min-width: 992px) {
        font-size: 14px;
      }
    }
  }

  &_article {
    grid-area: article;
    flex-direction: column;
    align-items: stretch;
    justify-content: center;

    & > *:not(:first-child) {
      margin-top: 5px;
    }

    &_rate {
      display: flex;
      align-items: center;
      width: 100%;

      & > *:not(:first-child) {
        margin-left: 5px;
      }
    }

    &-count {
      font-family: $ff-roboto;
      font-size: 14px;
    }

    &-review {
      font-family: $ff-gilroy;
      font-size: 14px;
      flex-direction: row !important;

      span {
        color: $c-green;
      }
    }

    &-address {
      font-family: $ff-gilroy;
      font-size: 14px;
    }
  }

  &_footer {
    grid-area: footer;

    & > *:not(:first-child) {
      margin-left: 5px;
    }

    &-time {
      display: flex;
      align-items: center;
      justify-content: start;
      font-family: $ff-roboto;
      font-size: 14px;
      color: $c-green;

      @media screen and (min-width: 992px) {
        font-size: 14px;
      }

      &-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 3px;
        width: 10px;
        height: 10px;
        object-fit: cover;

        @media screen and (min-width: 992px) {
          flex: 0 0 15px;
          width: 15px;
          height: 15px;
        }

        svg {
          width: 100%;
          height: 100%;
          fill: $c-primary;
        }
      }
    }

    &-seats {
      display: flex;
      align-items: center;
      font-family: $ff-gilroy;
      font-size: 14px;

      &-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 5px;
        margin-right: 3px;
        width: 10px;
        height: 10px;
        object-fit: cover;

        @media screen and (min-width: 992px) {
          flex: 0 0 15px;
          width: 15px;
          height: 15px;
        }

        svg {
          width: 100%;
          height: 100%;
        }
      }
    }
  }

  &-arrow {
    grid-area: arrow;
    align-self: center;

    img {
      flex: 0 0 15px;
      width: 15px;
      height: 15px;
    }
  }
}

@media screen and (max-width: 991px) {
  /deep/ .top {
    grid-template-columns: 1fr auto;
    grid-template-areas: 'header footer' 'article footer' 'article footer';
    grid-column-gap: 10px;

    margin: 0px;

    padding: 1rem;

    &_header-title {
      font-size: 14px;
      // margin-left: 2rem;
    }
    &_header-icon {
      width: 24px;
      height: 24px;
    }

    &_article-address {
      font-size: 14px;
    }

    &_article-review {
      font-size: 14px;
      margin-top: 3px;
      margin-left: 1rem;
      display: flex;
      flex-direction: row-reverse;
      span {
        margin: 0 0.5rem;
      }
    }
    &_article-count {
      font-size: 14px;
    }

    &_footer {
      align-self: end;
      flex-direction: column;

      &-time {
        width: 100%;
        font-size: 14px;

        &-icon {
          width: 20px;
          height: 20px;
        }
      }

      &-seats {
        align-self: flex-start;
        justify-self: flex-start;
        margin-left: 0;
        align-items: center;
        font-size: 14px;

        &-icon {
          width: 20px;
          height: 20px;
          margin-left: 0;
        }
      }
    }

    &-arrow {
      display: none;
    }
    &_footer-seats {
      margin-left: 0 !important;
    }
  }
}

.stars {
  display: flex;
  align-items: center;
  height: 100%;
}
</style>
